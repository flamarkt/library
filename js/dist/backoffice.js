module.exports=function(t){var n={};function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(o,i,function(n){return t[n]}.bind(null,i));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=29)}([function(t,n,e){"use strict";function o(t,n){return(o=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function i(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n)}e.d(n,"a",(function(){return i}))},function(t,n){t.exports=flarum.core.compat["common/extend"]},function(t,n){t.exports=flarum.core.compat["common/Model"]},function(t,n,e){"use strict";e.d(n,"a",(function(){return a}));var o=e(0),i=e(2),r=e.n(i),a=function(t){function n(){for(var n,e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return(n=t.call.apply(t,[this].concat(o))||this).conversions=r.a.attribute("conversions"),n.title=r.a.attribute("title"),n.description=r.a.attribute("description"),n}Object(o.a)(n,t);var e=n.prototype;return e.conversionUrl=function(t){return this.conversions()[t]?this.conversions()[t]:this.conversions()[Object.keys(this.conversions())[0]]},e.apiEndpoint=function(){return"/flamarkt/files"+(this.exists?"/"+this.data.id:"")},n}(r.a)},function(t,n){t.exports=flarum.core.compat["common/components/Button"]},function(t,n){t.exports=flarum.extensions["flamarkt-core"].common["models/Product"]},function(t,n){t.exports=flarum.extensions["flamarkt-core"].backoffice["pages/ProductShowPage"]},function(t,n){t.exports=flarum.extensions["flamarkt-core"].backoffice["components/ProductList"]},function(t,n){t.exports=flarum.extensions["flamarkt-core"].backoffice["components/BackofficeNav"]},function(t,n){t.exports=flarum.extensions["flamarkt-core"].common["components/ActiveLinkButton"]},function(t,n){t.exports=flarum.core.compat["common/components/Page"]},function(t,n){t.exports=flarum.extensions["flamarkt-core"].common["states/AbstractListState"]},function(t,n){t.exports=flarum.extensions["flamarkt-core"].backoffice["components/AbstractList"]},function(t,n){t.exports=flarum.core.compat["common/components/LinkButton"]},function(t,n){t.exports=flarum.extensions["flamarkt-core"].common["pages/AbstractShowPage"]},function(t,n){t.exports=flarum.extensions["flamarkt-core"].backoffice["components/SubmitButton"]},function(t,n){t.exports=flarum.core.compat["common/components/LoadingIndicator"]},function(t,n){t.exports=flarum.core.compat["common/components/Modal"]},function(t,n){t.exports=flarum.core.compat["common/utils/ItemList"]},,,,,,,,,,,function(t,n,e){"use strict";e.r(n);var o=e(3),i=e(8),r=e.n(i),a=e(7),c=e.n(a),s=e(6),u=e.n(s),l=e(9),f=e.n(l),p=e(5),d=e.n(p),h=e(1),b=e(4),y=e.n(b),v=e(0),x=e(10),g=e.n(x),k=e(11),O=function(t){function n(){return t.apply(this,arguments)||this}return Object(v.a)(n,t),n.prototype.type=function(){return"flamarkt/files"},n}(e.n(k).a),j=e(12),w=e.n(j),P=e(13),S=e.n(P),B=function(t){function n(){return t.apply(this,arguments)||this}Object(v.a)(n,t);var e=n.prototype;return e.head=function(){var n=t.prototype.head.call(this);return n.add("thumbnail",m("th",app.translator.trans("flamarkt-library.backoffice.files.head.thumbnail")),20),n.add("title",m("th",app.translator.trans("flamarkt-library.backoffice.files.head.title")),10),n},e.columns=function(n){var e=t.prototype.columns.call(this,n);return e.add("thumbnail",m("td",m("img",{src:n.conversionUrl("150x150"),alt:n.title()})),20),e.add("title",m("td",n.title()),10),e},e.actions=function(n){var e=t.prototype.actions.call(this,n);return e.add("edit",S.a.component({className:"Button Button--icon",icon:"fas fa-pen",href:app.route("files.show",{id:n.id()})})),e.add("hide",y.a.component({className:"Button Button--icon",icon:"fas fa-times"})),e},n}(w.a),_=function(t){function n(){for(var n,e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return(n=t.call.apply(t,[this].concat(o))||this).state=void 0,n.uploading=!1,n}Object(v.a)(n,t);var e=n.prototype;return e.oninit=function(n){t.prototype.oninit.call(this,n),this.state=new O,this.state.refresh()},e.view=function(){var t=this;return m(".FileIndexPage",m(".container",[m("input",{type:"file",onchange:function(n){var e=new FormData;e.append("file",n.target.files[0]),t.uploading=!0,m.redraw(),app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/flamarkt/files",serialize:function(t){return t},body:e}).then((function(n){t.uploading=!1,t.state.add(app.store.pushPayload(n)),m.redraw()})).catch((function(n){throw t.uploading=!1,m.redraw(),n}))}}),m(B,{state:this.state})]))},n}(g.a),F=e(14),L=e.n(F),T=e(15),A=e.n(T),M=e(16),N=e.n(M),U=function(t){function n(){for(var n,e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return(n=t.call.apply(t,[this].concat(o))||this).file=null,n.dirty=!1,n.saving=!1,n.title="",n.description="",n}Object(v.a)(n,t);var e=n.prototype;return e.findType=function(){return"flamarkt/files"},e.show=function(t){this.file=t,this.title=t.title()||"",this.description=t.description()||"",app.setTitle(t.title()),app.setTitleCount(0)},e.view=function(){var t=this;return this.file?m("form.FileShowPage",{onsubmit:this.onsubmit.bind(this)},m(".container",[m(".Form-group",[m("label",app.translator.trans("flamarkt-library.backoffice.files.field.title")),m("input.FormControl",{type:"text",value:this.title,oninput:function(n){t.title=n.target.value,t.dirty=!0}})]),m(".Form-group",[m("label",app.translator.trans("flamarkt-library.backoffice.files.field.description")),m("textarea.FormControl",{value:this.description,oninput:function(n){t.description=n.target.value,t.dirty=!0}})]),m(".Form-group",[A.a.component({loading:this.saving,dirty:this.dirty,exists:this.file.exists})])])):N.a.component()},e.data=function(){return{title:this.title,description:this.description}},e.onsubmit=function(t){var n=this;t.preventDefault(),this.saving=!0,this.file.save(this.data()).then((function(t){n.file=t,n.saving=!1,n.dirty=!1,m.redraw()})).catch((function(t){n.saving=!1,m.redraw()}))},n}(L.a),C=e(17),I=e.n(C),z=e(18),D=e.n(z),R=function(t){function n(){return t.apply(this,arguments)||this}return Object(v.a)(n,t),n.prototype.actions=function(t){var n=this,e=new D.a;return e.add("select",y.a.component({className:"Button",icon:"fas fa-check",onclick:function(){n.attrs.onselect(t)}},"Select")),e},n}(B),q=function(t){function n(){return t.apply(this,arguments)||this}Object(v.a)(n,t);var e=n.prototype;return e.oninit=function(n){t.prototype.oninit.call(this,n),this.state=new O,this.state.refresh()},e.title=function(){return"Select a file"},e.content=function(){var t=this;return m(".Modal-body",m(R,{state:this.state,onselect:function(n){t.attrs.onselect(n),t.hide()}}))},n}(I.a),E=e(2),G=e.n(E);app.initializers.add("flamarkt-library",(function(){app.store.models["flamarkt-files"]=o.a,d.a.prototype.thumbnail=G.a.hasOne("thumbnail"),app.routes["files.index"]={path:"/files",component:_},app.routes["files.show"]={path:"/files/:id",component:U},Object(h.extend)(r.a.prototype,"items",(function(t){t.add("library",f.a.component({href:app.route("files.index"),icon:"fas fa-file",activeRoutes:["files.*"]},"Library"))})),Object(h.extend)(c.a.prototype,"head",(function(t){t.add("thumbnail",m("th","Thumbnail"),30)})),Object(h.extend)(c.a.prototype,"columns",(function(t,n){var e=n.thumbnail();t.add("thumbnail",m("td",e?m("img",{src:e.conversionUrl("150x150"),alt:n.title()}):null),30)})),Object(h.extend)(u.a.prototype,"oninit",(function(){this.thumbnail=null})),Object(h.extend)(u.a.prototype,"show",(function(t,n){this.thumbnail=n.thumbnail()||null})),Object(h.extend)(u.a.prototype,"fields",(function(t){var n=this;t.add("thumbnail",m(".Form-group",[m("label","Thumbnail"),this.thumbnail?[m("img",{src:this.thumbnail.conversionUrl("150x150")}),y.a.component({className:"Button",icon:"fas fa-times",onclick:function(){n.thumbnail=null,n.dirty=!0}},"Remove")]:null,y.a.component({className:"Button",icon:"fas fa-file",onclick:function(){app.modal.show(q,{onselect:function(t){n.thumbnail=t,n.dirty=!0}})}},"Choose")]))})),Object(h.extend)(u.a.prototype,"data",(function(t){t.relationships=t.relationships||{},t.relationships.thumbnail=this.thumbnail}))}))}]);
//# sourceMappingURL=backoffice.js.map