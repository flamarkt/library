{"version":3,"file":"backoffice.js","mappings":"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","sources":["webpack://@flamarkt/library/webpack/bootstrap","webpack://@flamarkt/library/webpack/runtime/compat get default export","webpack://@flamarkt/library/webpack/runtime/define property getters","webpack://@flamarkt/library/webpack/runtime/hasOwnProperty shorthand","webpack://@flamarkt/library/webpack/runtime/make namespace object","webpack://@flamarkt/library/external root \"((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['app']\"","webpack://@flamarkt/library/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@flamarkt/library/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flamarkt/library/external root \"flarum.core.compat['common/Model']\"","webpack://@flamarkt/library/./src/common/models/File.ts","webpack://@flamarkt/library/external root \"((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/BackofficeNav']\"","webpack://@flamarkt/library/external root \"((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['components/ActiveLinkButton']\"","webpack://@flamarkt/library/external root \"((flarum.extensions['flamarkt-core']||{})['backoffice']||{})['components/ProductList']\"","webpack://@flamarkt/library/external root \"((flarum.extensions['flamarkt-core']||{})['backoffice']||{})['pages/ProductShowPage']\"","webpack://@flamarkt/library/external root \"((flarum.extensions['flamarkt-core']||{})['common']||{})['models/Product']\"","webpack://@flamarkt/library/external root \"flarum.core.compat['common/extend']\"","webpack://@flamarkt/library/external root \"flarum.core.compat['common/components/Button']\"","webpack://@flamarkt/library/external root \"((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/SearchInput']\"","webpack://@flamarkt/library/external root \"flarum.core.compat['common/components/Page']\"","webpack://@flamarkt/library/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@flamarkt/library/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@flamarkt/library/external root \"((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['states/AbstractListState']\"","webpack://@flamarkt/library/./src/backoffice/states/FileListState.ts","webpack://@flamarkt/library/external root \"((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/AbstractList']\"","webpack://@flamarkt/library/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@flamarkt/library/./src/backoffice/components/FileList.ts","webpack://@flamarkt/library/./src/backoffice/pages/FileIndexPage.ts","webpack://@flamarkt/library/external root \"((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['pages/AbstractShowPage']\"","webpack://@flamarkt/library/external root \"((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/SubmitButton']\"","webpack://@flamarkt/library/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@flamarkt/library/./src/backoffice/pages/FileShowPage.ts","webpack://@flamarkt/library/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@flamarkt/library/./src/backoffice/components/FileSelectList.ts","webpack://@flamarkt/library/./src/backoffice/components/FileSelectionModal.ts","webpack://@flamarkt/library/./src/backoffice/index.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['app'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","import Model from 'flarum/common/Model';\n\nexport default class File extends Model {\n    conversions = Model.attribute<{ [key: string]: string }>('conversions');\n    title = Model.attribute<string>('title');\n    description = Model.attribute<string>('description');\n\n    conversionUrl(name: string) {\n        if (this.conversions()[name]) {\n            return this.conversions()[name];\n        }\n\n        // Default to first conversion TODO: add logic\n        return this.conversions()[Object.keys(this.conversions())[0]];\n    }\n\n    apiEndpoint() {\n        return '/flamarkt/files' + (this.exists ? '/' + (this.data as any).id : '');\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/BackofficeNav'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['components/ActiveLinkButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-core']||{})['backoffice']||{})['components/ProductList'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-core']||{})['backoffice']||{})['pages/ProductShowPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-core']||{})['common']||{})['models/Product'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/SearchInput'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Page'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['states/AbstractListState'];","import AbstractListState from 'flamarkt/backoffice/common/states/AbstractListState';\nimport File from '../../common/models/File';\n\nexport default class FileListState extends AbstractListState<File> {\n    type() {\n        return 'flamarkt/files';\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/AbstractList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","import app from 'flamarkt/backoffice/backoffice/app';\nimport AbstractList from 'flamarkt/backoffice/backoffice/components/AbstractList';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport File from '../../common/models/File';\n\nexport default class FileList extends AbstractList<File> {\n    head() {\n        const columns = super.head();\n\n        columns.add('thumbnail', m('th', app.translator.trans('flamarkt-library.backoffice.files.head.thumbnail')), 20);\n        columns.add('title', m('th', app.translator.trans('flamarkt-library.backoffice.files.head.title')), 10);\n\n        return columns;\n    }\n\n    columns(file: File) {\n        const columns = super.columns(file);\n\n        columns.add('thumbnail', m('td', m('img', {\n            src: file.conversionUrl('150x150'),\n            alt: file.title(),\n        })), 20);\n        columns.add('title', m('td', file.title()), 10);\n\n        return columns;\n    }\n\n    actions(file: File) {\n        const actions = super.actions(file);\n\n        actions.add('edit', LinkButton.component({\n            className: 'Button Button--icon',\n            icon: 'fas fa-pen',\n            href: app.route('files.show', {\n                id: file.id(),\n            }),\n        }));\n\n        return actions;\n    }\n}\n","import {Vnode} from 'mithril';\nimport app from 'flamarkt/backoffice/backoffice/app';\nimport SearchInput from 'flamarkt/backoffice/backoffice/components/SearchInput';\nimport Page from 'flarum/common/components/Page';\nimport extractText from 'flarum/common/utils/extractText';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport {ApiPayloadSingle} from 'flarum/common/Store';\nimport FileListState from '../states/FileListState';\nimport FileList from '../components/FileList';\n\nexport default class FileIndexPage extends Page {\n    list!: FileListState;\n    uploading: boolean = false;\n\n    oninit(vnode: Vnode) {\n        super.oninit(vnode);\n\n        this.list = new FileListState();\n        this.list.refresh();\n    }\n\n    filters() {\n        const items = new ItemList();\n\n        items.add('search', m(SearchInput, {\n            initialValue: '',\n            onchange: (value: string) => {\n                this.list.params.q = value;\n                this.list.refresh();\n            },\n            placeholder: extractText(app.translator.trans('flamarkt-library.backoffice.files.searchPlaceholder')),\n        }), 50);\n\n        items.add('separator', m('.BackofficeListFilters--separator'), -10);\n\n        items.add('upload', m('input', {\n            type: 'file',\n            onchange: (event: InputEvent) => {\n                const body = new FormData();\n\n                body.append('file', (event.target as HTMLInputElement).files![0]);\n\n                this.uploading = true;\n                m.redraw();\n\n                app.request<ApiPayloadSingle>({\n                    method: 'POST',\n                    url: app.forum.attribute('apiUrl') + '/flamarkt/files',\n                    serialize: (raw: any) => raw,\n                    body,\n                }).then(result => {\n                    this.uploading = false;\n                    this.list.add(app.store.pushPayload(result));\n                    m.redraw();\n                }).catch(err => {\n                    this.uploading = false;\n                    m.redraw();\n                    throw err;\n                });\n            }\n        }), -100);\n\n        return items;\n    }\n\n    view() {\n        return m('.FileIndexPage', m('.container', [\n            m('.BackofficeListFilters', this.filters().toArray()),\n            m(FileList, {\n                list: this.list,\n            }),\n        ]));\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['common']||{})['pages/AbstractShowPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-backoffice']||{})['backoffice']||{})['components/SubmitButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","import app from 'flamarkt/backoffice/backoffice/app';\nimport AbstractShowPage from 'flamarkt/backoffice/common/pages/AbstractShowPage';\nimport SubmitButton from 'flamarkt/backoffice/backoffice/components/SubmitButton';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport File from '../../common/models/File';\n\nexport default class FileShowPage extends AbstractShowPage {\n    file: File | null = null;\n    dirty: boolean = false;\n    saving: boolean = false;\n    title: string = '';\n    description: string = '';\n\n    findType() {\n        return 'flamarkt/files';\n    }\n\n    show(file: File) {\n        this.file = file;\n        this.title = file.title() || '';\n        this.description = file.description() || '';\n\n        app.setTitle(file.title());\n        app.setTitleCount(0);\n    }\n\n    view() {\n        if (!this.file) {\n            return LoadingIndicator.component();\n        }\n\n        return m('form.FileShowPage', {\n            onsubmit: this.onsubmit.bind(this),\n        }, m('.container', [\n            m('.Form-group', [\n                m('label', app.translator.trans('flamarkt-library.backoffice.files.field.title')),\n                m('input.FormControl', {\n                    type: 'text',\n                    value: this.title,\n                    oninput: (event: InputEvent) => {\n                        this.title = (event.target as HTMLInputElement).value;\n                        this.dirty = true;\n                    },\n                }),\n            ]),\n            m('.Form-group', [\n                m('label', app.translator.trans('flamarkt-library.backoffice.files.field.description')),\n                m('textarea.FormControl', {\n                    value: this.description,\n                    oninput: (event: InputEvent) => {\n                        this.description = (event.target as HTMLInputElement).value;\n                        this.dirty = true;\n                    },\n                }),\n            ]),\n            m('.Form-group', [\n                SubmitButton.component({\n                    loading: this.saving,\n                    dirty: this.dirty,\n                    exists: this.file.exists,\n                }),\n            ]),\n        ]));\n    }\n\n    data() {\n        return {\n            title: this.title,\n            description: this.description,\n        };\n    }\n\n    onsubmit(event: Event) {\n        event.preventDefault();\n\n        this.saving = true;\n\n        // @ts-ignore\n        this.file.save(this.data()).then(file => {\n            this.file = file;\n\n            this.saving = false;\n            this.dirty = false;\n            m.redraw();\n        }).catch(error => {\n            this.saving = false;\n            m.redraw();\n        });\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","import FileList from './FileList';\nimport File from '../../common/models/File';\nimport Button from 'flarum/common/components/Button';\nimport ItemList from 'flarum/common/utils/ItemList';\n\nexport default class FileSelectList extends FileList {\n    actions(file: File) {\n        const actions = new ItemList();\n\n        actions.add('select', Button.component({\n            className: 'Button',\n            icon: 'fas fa-check',\n            onclick: () => {\n                this.attrs.onselect(file);\n            },\n        }, 'Select'));\n\n        return actions;\n    }\n}\n","import app from 'flamarkt/backoffice/backoffice/app';\nimport SearchInput from 'flamarkt/backoffice/backoffice/components/SearchInput';\nimport Modal, {IInternalModalAttrs} from 'flarum/common/components/Modal';\nimport extractText from 'flarum/common/utils/extractText';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport FileListState from '../states/FileListState';\nimport FileSelectList from './FileSelectList';\nimport File from '../../common/models/File';\n\ninterface FileSelectionModalAttrs extends IInternalModalAttrs {\n    onselect: (file: File) => void\n}\n\nexport default class FileSelectionModal extends Modal<FileSelectionModalAttrs> {\n    list!: FileListState\n\n    oninit(vnode: any) {\n        super.oninit(vnode);\n\n        this.list = new FileListState();\n        this.list.refresh();\n    }\n\n    className() {\n        return 'FlamarktLibrarySelectionModal';\n    }\n\n    title() {\n        return app.translator.trans('flamarkt-library.backoffice.select.title');\n    }\n\n    filters() {\n        const items = new ItemList();\n\n        items.add('search', m(SearchInput, {\n            initialValue: '',\n            onchange: (value: string) => {\n                this.list.params.q = value;\n                this.list.refresh();\n            },\n            placeholder: extractText(app.translator.trans('flamarkt-library.backoffice.files.searchPlaceholder')),\n        }), 50);\n\n        return items;\n    }\n\n    content() {\n        return m('.Modal-body', [\n            m('.BackofficeListFilters', this.filters().toArray()),\n            m(FileSelectList, {\n                state: this.list,\n                onselect: (file: File) => {\n                    this.attrs.onselect(file);\n                    this.hide();\n                },\n            }),\n        ]);\n    }\n}\n","import app from 'flamarkt/backoffice/backoffice/app';\nimport File from '../common/models/File';\nimport BackofficeNav from 'flamarkt/backoffice/backoffice/components/BackofficeNav';\nimport ActiveLinkButton from 'flamarkt/backoffice/common/components/ActiveLinkButton';\nimport ProductList from 'flamarkt/core/backoffice/components/ProductList';\nimport ProductShowPage from 'flamarkt/core/backoffice/pages/ProductShowPage';\nimport Product from 'flamarkt/core/common/models/Product';\nimport {extend} from 'flarum/common/extend';\nimport Button from 'flarum/common/components/Button';\nimport FileIndexPage from './pages/FileIndexPage';\nimport FileShowPage from './pages/FileShowPage';\nimport FileSelectionModal from './components/FileSelectionModal';\nimport Model from 'flarum/common/Model';\n\napp.initializers.add('flamarkt-library', () => {\n    app.store.models['flamarkt-files'] = File;\n\n    Product.prototype.thumbnail = Model.hasOne('thumbnail');\n\n    app.routes['files.index'] = {\n        path: '/files',\n        component: FileIndexPage,\n    };\n    app.routes['files.show'] = {\n        path: '/files/:id',\n        component: FileShowPage,\n    };\n\n    extend(BackofficeNav.prototype, 'items', function (items) {\n        items.add('library', ActiveLinkButton.component({\n            href: app.route('files.index'),\n            icon: 'fas fa-file',\n            activeRoutes: [\n                'files.*',\n            ],\n        }, 'Library'));\n    });\n\n    extend(ProductList.prototype, 'head', function (columns) {\n        columns.add('thumbnail', m('th', 'Thumbnail'), 30);\n    });\n\n    extend(ProductList.prototype, 'columns', function (columns, product) {\n        const file = product.thumbnail();\n\n        columns.add('thumbnail', m('td', file ? m('img', {\n            src: file.conversionUrl('150x150'),\n            alt: product.title(),\n        }) : null), 30);\n    });\n\n    extend(ProductShowPage.prototype, 'oninit', function () {\n        this.thumbnail = null;\n    });\n\n    extend(ProductShowPage.prototype, 'show', function (returnValue, product) {\n        this.thumbnail = product.thumbnail() || null;\n    });\n\n    extend(ProductShowPage.prototype, 'fields', function (fields) {\n        fields.add('thumbnail', m('.Form-group', [\n            m('label', 'Thumbnail'),\n            this.thumbnail ? [\n                m('img', {\n                    src: this.thumbnail.conversionUrl('150x150'),\n                }),\n                Button.component({\n                    className: 'Button',\n                    icon: 'fas fa-times',\n                    onclick: () => {\n                        this.thumbnail = null;\n                        this.dirty = true;\n                    },\n                }, 'Remove'),\n            ] : null,\n            Button.component({\n                className: 'Button',\n                icon: 'fas fa-file',\n                onclick: () => {\n                    app.modal.show(FileSelectionModal, {\n                        onselect: (file: File) => {\n                            this.thumbnail = file;\n                            this.dirty = true;\n                        },\n                    });\n                },\n            }, 'Choose'),\n        ]));\n    });\n\n    extend(ProductShowPage.prototype, 'data', function (data: any) {\n        data.relationships = data.relationships || {};\n        data.relationships.thumbnail = this.thumbnail;\n    });\n});\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","extensions","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","core","compat","File","conversions","Model","title","description","conversionUrl","name","this","keys","apiEndpoint","exists","data","id","FileListState","type","AbstractListState","FileList","head","columns","add","m","app","file","src","alt","actions","LinkButton","className","icon","href","AbstractList","FileIndexPage","list","uploading","oninit","vnode","refresh","filters","items","ItemList","SearchInput","initialValue","onchange","params","q","placeholder","extractText","event","body","FormData","append","target","files","redraw","method","url","serialize","raw","then","result","err","view","toArray","Page","FileShowPage","dirty","saving","findType","show","onsubmit","oninput","SubmitButton","loading","LoadingIndicator","preventDefault","save","error","AbstractShowPage","FileSelectList","Button","onclick","attrs","onselect","FileSelectionModal","content","state","hide","Modal","Product","path","component","extend","BackofficeNav","ActiveLinkButton","activeRoutes","ProductList","product","thumbnail","ProductShowPage","returnValue","fields","relationships"],"sourceRoot":""}