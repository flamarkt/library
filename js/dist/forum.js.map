{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@flamarkt/library/webpack/bootstrap","webpack://@flamarkt/library/webpack/runtime/compat get default export","webpack://@flamarkt/library/webpack/runtime/define property getters","webpack://@flamarkt/library/webpack/runtime/hasOwnProperty shorthand","webpack://@flamarkt/library/webpack/runtime/make namespace object","webpack://@flamarkt/library/external root \"flarum.core.compat['common/extend']\"","webpack://@flamarkt/library/external root \"((flarum.extensions['flamarkt-core']||{})['common']||{})['models/Product']\"","webpack://@flamarkt/library/external root \"((flarum.extensions['flamarkt-core']||{})['forum']||{})['components/ProductListItem']\"","webpack://@flamarkt/library/external root \"((flarum.extensions['flamarkt-core']||{})['forum']||{})['layouts/ProductShowLayout']\"","webpack://@flamarkt/library/external root \"((flarum.extensions['flamarkt-core']||{})['forum']||{})['components/OrderTable']\"","webpack://@flamarkt/library/external root \"((flarum.extensions['flamarkt-core']||{})['forum']||{})['components/OrderTableGroupFoot']\"","webpack://@flamarkt/library/external root \"((flarum.extensions['flamarkt-core']||{})['forum']||{})['components/OrderTableGroupHead']\"","webpack://@flamarkt/library/external root \"((flarum.extensions['flamarkt-core']||{})['forum']||{})['components/OrderTableRow']\"","webpack://@flamarkt/library/external root \"flarum.core.compat['common/Model']\"","webpack://@flamarkt/library/external root \"flarum.core.compat['common/components/Link']\"","webpack://@flamarkt/library/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@flamarkt/library/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flamarkt/library/./src/common/models/File.ts","webpack://@flamarkt/library/external root \"flarum.core.compat['common/Component']\"","webpack://@flamarkt/library/./src/forum/components/Image.ts","webpack://@flamarkt/library/./src/common/compat.ts","webpack://@flamarkt/library/./src/forum/compat.ts","webpack://@flamarkt/library/./src/forum/index.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-core']||{})['common']||{})['models/Product'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-core']||{})['forum']||{})['components/ProductListItem'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-core']||{})['forum']||{})['layouts/ProductShowLayout'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-core']||{})['forum']||{})['components/OrderTable'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-core']||{})['forum']||{})['components/OrderTableGroupFoot'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-core']||{})['forum']||{})['components/OrderTableGroupHead'];","const __WEBPACK_NAMESPACE_OBJECT__ = ((flarum.extensions['flamarkt-core']||{})['forum']||{})['components/OrderTableRow'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Link'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","import Model from 'flarum/common/Model';\n\nexport default class File extends Model {\n    conversions = Model.attribute<{ [key: string]: string }>('conversions');\n    title = Model.attribute<string>('title');\n    description = Model.attribute<string>('description');\n\n    conversionUrl(name: string) {\n        if (this.conversions()[name]) {\n            return this.conversions()[name];\n        }\n\n        // Default to first conversion TODO: add logic\n        return this.conversions()[Object.keys(this.conversions())[0]];\n    }\n\n    apiEndpoint() {\n        return '/flamarkt/files' + (this.exists ? '/' + (this.data as any).id : '');\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","import Component, {ComponentAttrs} from 'flarum/common/Component';\nimport File from '../../common/models/File';\n\ninterface ImageAttrs extends ComponentAttrs {\n    file?: File\n    size?: string\n    className?: string\n}\n\nexport default class Image extends Component<ImageAttrs> {\n    view() {\n        const {file, size, className} = this.attrs;\n\n        if (!file) {\n            return m('span.FlamarktThumbnail', {\n                className,\n            }, 'No image');\n        }\n\n        return m('img.FlamarktThumbnail', {\n            src: file.conversionUrl(size || '150x150'),\n            alt: file.title(),\n            className,\n        });\n    }\n}\n","import File from './models/File';\n\nexport const common = {\n    'models/File': File,\n};\n","import Image from './components/Image';\n\nexport const forum = {\n    'components/Image': Image,\n};\n","import {extend} from 'flarum/common/extend';\nimport Product from 'flamarkt/core/common/models/Product';\nimport ProductListItem from 'flamarkt/core/forum/components/ProductListItem';\nimport ProductShowLayout from 'flamarkt/core/forum/layouts/ProductShowLayout';\nimport OrderTable from 'flamarkt/core/forum/components/OrderTable';\nimport OrderTableGroupFoot from 'flamarkt/core/forum/components/OrderTableGroupFoot';\nimport OrderTableGroupHead from 'flamarkt/core/forum/components/OrderTableGroupHead';\nimport OrderTableRow from 'flamarkt/core/forum/components/OrderTableRow';\nimport Model from 'flarum/common/Model';\nimport Link from 'flarum/common/components/Link';\nimport File from '../common/models/File';\nimport Image from './components/Image';\nimport {common} from '../common/compat';\nimport {forum} from './compat';\n\nexport {\n    common,\n    forum,\n}\n\napp.initializers.add('flamarkt-library', () => {\n    app.store.models['flamarkt-files'] = File;\n\n    Product.prototype.thumbnail = Model.hasOne('thumbnail');\n\n    extend(ProductListItem.prototype, 'items', function (items) {\n        const file = this.attrs.product.thumbnail();\n\n        items.add('thumbnail', Image.component({\n            className: 'ProductListItem--thumbnail',\n            file,\n        }), 30);\n    });\n\n    extend(ProductShowLayout.prototype, 'gallerySection', function (items, product) {\n        const file = product.thumbnail();\n\n        items.add('thumbnail', Image.component({\n            file,\n            size: 400,\n        }));\n    });\n\n    extend(OrderTable.prototype, ['head', 'foot'], function (items) {\n        items.add('thumbnail', m('th'), 31);\n    });\n\n    extend(OrderTableGroupFoot.prototype, 'columns', function (items) {\n        items.add('thumbnail', m('th'), 31);\n    });\n\n    extend(OrderTableGroupHead.prototype, 'columns', function (items) {\n        items.add('thumbnail', m('th'), 31);\n    });\n\n    extend(OrderTableRow.prototype, 'columns', function (items) {\n        const product = this.attrs.line.product();\n\n        items.add('thumbnail', m('td', product ? m(Link, {\n            href: app.route.product(product),\n        }, Image.component({\n            file: product ? product.thumbnail() : null,\n        })) : null), 31);\n    });\n});\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","extensions","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","File","conversions","Model","title","description","conversionUrl","name","this","keys","apiEndpoint","exists","data","id","Image","view","attrs","file","size","className","m","src","alt","Component","common","forum","app","initializers","add","store","models","Product","extend","ProductListItem","items","product","thumbnail","component","ProductShowLayout","OrderTable","OrderTableGroupFoot","OrderTableGroupHead","OrderTableRow","line","Link","href","route"],"sourceRoot":""}